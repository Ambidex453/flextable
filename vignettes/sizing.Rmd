---
title: "Flextable sizing"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Flextable sizing}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r echo = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```

```{r warning=FALSE}
library(flextable)
library(oxbase)
library(magrittr)
```


The default sizes of flextable columns and rows are calculated with a simple algorithm. This will drive to inadequate rows heights and columns widths in some cases (when data values are wider than headers). You can use function `dim` to get flextable dimensions. 

```{r}
ft_base <- flextable(head(iris)) %>% 
  theme_tron_legacy()
tabwid(ft_base)
dim(ft_base)
```

## Pretty dimensions

Function `dim_pretty` is computing optimized widths and heights. 

```{r}
dim_pretty(ft_base)
```

This function is time consuming and should be used sparingly.

## Adjusts automatically cell widths and heights

Function `autofit` is computing optimized widths and heights and apply the results to the object. 

```{r}
ft <- ft_base %>% autofit(add_w = 0, add_h = 0)

dim(ft)
tabwid(ft)
```

## Adjusts manually cell widths and heights

Function `width` and `height` let you control dimensions of a flextable. 

```{r}
ft <- ft_base %>% autofit() %>% 
  width(j = ~ Species, width = 2) %>% 
  height(i = 4:5, height = .5)
tabwid(ft)
```

