---
title: "Format `flextable` objects"
author: "David Gohel"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{flextable_format}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r warning=FALSE, message=FALSE, echo=FALSE}
library(flextable)
library(oxbase)
library(dplyr)
```


Formatting `flextable` can be made with simple functions. 


## Shortcuts functions

There are simple functions to modify formatting properties of flextable objects: `bg`, `bold`, `border`, `color`, `padding`.

```{r}
myft <- flextable(head(iris))
tabwid(myft)
```

#### bold

```{r}
myft <- flextable(head(iris)) %>% 
  # bold header
  bold(part = "header") 
tabwid(myft)
```

#### change font color

```{r}
myft <- myft %>% color(color = "#E4C994")
tabwid(myft)
```

#### change background color

```{r}
myft <- myft %>% 
  # light gray as background color for header
  bg(bg = "#F0F0F0", part = "header") %>% 
  # dark gray as background color for body
  bg(bg = "#333333", part = "body")

tabwid(myft)
```

#### add padding

```{r}
myft <- myft %>% padding( padding = 3, part = "all" )
tabwid(myft)
```

#### change border

```{r}
myft <- myft %>% 
  border( border.top = fp_border(color="orange"), 
          border.bottom = fp_border(color="orange"), 
          border.left = fp_border(color="white"), 
          border.right = fp_border(color="white"), 
          part = "all" )
  
tabwid(myft)
```


## Conditional formatting


Conditional formatting can be made by using the selector arguments.

```{r warning=FALSE, message=FALSE}
myft <- myft %>% 
  color(i = ~ Sepal.Length < 5 & Petal.Length > 1.3, 
        j = ~ Petal.Width + Species, 
        color="red") 
tabwid(myft)
```



## `style` function

The `style` function lets you style a selection of the flextable with formatting properties.


```{r}
ft <- flextable(head(mtcars, n = 10 )) %>% theme_vanilla() %>% 
  style( i = ~ drat > 3.5, j = ~ vs + am + gear + carb, 
        pr_t = fp_text(color="#C9C923", italic = TRUE) )
tabwid(ft)
```

Eventually 3 formatting properties can be used: text, paragraphs and cells formatting properties.


```{r}
def_cell <- fp_cell(border = fp_border(color="#00C9C9"))
def_par <- fp_par(text.align = "center")
def_text <- fp_text(color="#999999", italic = TRUE)
def_text_header <- update(color="black", def_text, bold = TRUE)

ft <- flextable(head(mtcars, n = 10 )) %>% 
  style( pr_c = def_cell, pr_p = def_par, pr_t = def_text, part = "all") %>% 
  style( pr_c = def_cell, pr_p = def_par, 
         pr_t = def_text_header, part = "header") %>% 
  style( ~ drat > 3.5, ~ vs + gear + carb, 
         pr_c = update(def_cell, background.color = rgb(.8,.2,.2, .1) ), 
         pr_t = fp_text(color="#C9C923", italic = TRUE) )
tabwid(ft)
```

