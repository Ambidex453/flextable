---
title: "flextable overview"
output: 
  rmarkdown::html_vignette:
    toc: true 
    toc_depth: 3
vignette: >
  %\VignetteIndexEntry{flextable overview}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
library(flextable)
library(magrittr)
library(htmltools)

knitr::opts_chunk$set(
  message = FALSE,
  collapse = TRUE,
  comment = "#>", 
  eval = !is.null(knitr::opts_knit$get("rmarkdown.pandoc.to"))
)
```

## Introduction 

`flextable` can easily create reporting table from `data.frame`. You 
can merge cells, add header rows, add footer rows, change any format 
and specify how data should be displayed in cells. Tables content can also 
contain mixed type of content, text and images.


<svg xmlns="http://www.w3.org/2000/svg" width="75" viewBox="0 0 512 512">
	<title>HTML5 Logo</title>
	<path d="M108.4 0h23v22.8h21.2V0h23v69h-23V46h-21v23h-23.2M206 23h-20.3V0h63.7v23H229v46h-23M259.5 0h24.1l14.8 24.3L313.2 0h24.1v69h-23V34.8l-16.1 24.8l-16.1-24.8v34.2h-22.6M348.7 0h23v46.2h32.6V69h-55.6"/>
	<path fill="#e44d26" d="M107.6 471l-33-370.4h362.8l-33 370.2L255.7 512"/>
	<path fill="#f16529" d="M256 480.5V131H404.3L376 447"/>
	<path fill="#ebebeb" d="M142 176.3h114v45.4h-64.2l4.2 46.5h60v45.3H154.4M156.4 336.3H202l3.2 36.3 50.8 13.6v47.4l-93.2-26"/>
	<path fill="#fff" d="M369.6 176.3H255.8v45.4h109.6M361.3 268.2H255.8v45.4h56l-5.3 59-50.7 13.6v47.2l93-25.8"/>
</svg> 

<svg viewBox="0 0 88.024445 86" width="75" xmlns="http://www.w3.org/2000/svg">
  <g id="g3103" transform="matrix(1, 0, 0, 1, -21.015556, 0)">
    <path id="path6" d="M 67.02,0 73,0 c 0,2.67 0,5.33 0,8 10.7,0.06 21.39,-0.11 32.08,0.06 2.28,-0.23 4.07,1.54 3.86,3.82 0.17,19.7 -0.04,39.41 0.1,59.11 -0.1,2.02 0.2,4.26 -0.97,6.05 -1.46,1.04 -3.35,0.91 -5.05,0.99 C 93.01,77.98 83.01,78 73,78 c 0,2.67 0,5.33 0,8 l -6.25,0 C 51.53,83.22 36.27,80.67 21.02,78 21.01,54.67 21.02,31.34 21.02,8.02 36.35,5.34 51.69,2.73 67.02,0 z" style="fill:#2a5699"/>
    <path id="path46" d="m 73,11 c 11,0 22,0 33,0 0,21.33 0,42.67 0,64 -11,0 -22,0 -33,0 0,-2.67 0,-5.33 0,-8 8.67,0 17.33,0 26,0 0,-1.33 0,-2.67 0,-4 -8.67,0 -17.33,0 -26,0 0,-1.67 0,-3.33 0,-5 8.67,0 17.33,0 26,0 0,-1.33 0,-2.67 0,-4 -8.67,0 -17.33,0 -26,0 0,-1.67 0,-3.33 0,-5 8.67,0 17.33,0 26,0 0,-1.33 0,-2.67 0,-4 -8.67,0 -17.33,0 -26,0 0,-1.67 0,-3.33 0,-5 8.67,0 17.33,0 26,0 0,-1.33 0,-2.67 0,-4 -8.67,0 -17.33,0 -26,0 0,-1.67 0,-3.33 0,-5 8.67,0 17.33,0 26,0 0,-1.33 0,-2.67 0,-4 -8.67,0 -17.33,0 -26,0 0,-1.67 0,-3.33 0,-5 8.67,0 17.33,0 26,0 0,-1.33 0,-2.67 0,-4 -8.67,0 -17.33,0 -26,0 0,-2.33 0,-4.67 0,-7 z" style="fill:#ffffff"/>
    <path id="path88" d="m 41.68,28.67 c 1.9,-0.11 3.8,-0.19 5.7,-0.29 1.33,6.75 2.69,13.49 4.13,20.21 1.13,-6.94 2.38,-13.86 3.59,-20.79 2,-0.07 4,-0.18 5.99,-0.3 -2.26,9.69 -4.24,19.46 -6.71,29.09 -1.67,0.87 -4.17,-0.04 -6.15,0.1 -1.33,-6.62 -2.88,-13.2 -4.07,-19.85 -1.17,6.46 -2.69,12.86 -4.03,19.28 -1.92,-0.1 -3.85,-0.22 -5.78,-0.35 -1.66,-8.8 -3.61,-17.54 -5.16,-26.36 1.71,-0.08 3.43,-0.15 5.14,-0.21 1.03,6.37 2.2,12.71 3.1,19.09 1.41,-6.54 2.85,-13.08 4.25,-19.62 z" style="fill:#ffffff"/>
  </g>
</svg> 

<svg xmlns="http://www.w3.org/2000/svg" width="75" viewBox="0 0 32 32"><title>OfficeCore10_32x_24x_20x_16x_01-22-2019</title><g id="STYLE_COLOR" data-name="STYLE = COLOR"><path d="M17.99964,2a14.04114,14.04114,0,0,0-14,14l17.737,3.737Z" fill="#ed6c47"/><path d="M17.99964,2a14.04114,14.04114,0,0,1,14,14l-7,4.75791-7-4.75791Z" fill="#ff8f6b"/><path d="M17.99963,30a14.04114,14.04114,0,0,0,14-14h-28A14.04115,14.04115,0,0,0,17.99963,30Z" fill="#d35230"/><path d="M16.66644,7H7.30511a13.91368,13.91368,0,0,0,.93073,19h8.4306a1.33732,1.33732,0,0,0,1.33338-1.33337V8.33331A1.33727,1.33727,0,0,0,16.66644,7Z" opacity="0.1"/><path d="M15.66644,8H6.53876A13.906,13.906,0,0,0,9.38434,27h6.2821a1.33732,1.33732,0,0,0,1.33338-1.33337V9.33331A1.33727,1.33727,0,0,0,15.66644,8Z" opacity="0.2"/><path d="M15.66644,8H6.53876a13.88991,13.88991,0,0,0,.76635,17h8.36133a1.33732,1.33732,0,0,0,1.33338-1.33337V9.33331A1.33727,1.33727,0,0,0,15.66644,8Z" opacity="0.2"/><path d="M14.66644,8H6.53876a13.88991,13.88991,0,0,0,.76635,17h7.36133a1.33732,1.33732,0,0,0,1.33338-1.33337V9.33331A1.33727,1.33727,0,0,0,14.66644,8Z" opacity="0.2"/><path id="Back_Plate" data-name="Back Plate" d="M1.33333,8H14.66669A1.33334,1.33334,0,0,1,16,9.33334V22.66666A1.33333,1.33333,0,0,1,14.6667,24H1.33334A1.33334,1.33334,0,0,1,0,22.66666V9.33333A1.33333,1.33333,0,0,1,1.33333,8Z" fill="#c43e1c"/><path d="M7.9975,11a4.16771,4.16771,0,0,1,2.75484.8051,2.87757,2.87757,0,0,1,.95562,2.33129,2.72609,2.72609,0,0,1-.47255,1.58724,3.16371,3.16371,0,0,1-1.34417,1.18676,4.56975,4.56975,0,0,1-2.01976.42344H5.96025V21H4V11ZM5.96025,15.68319H7.64746a2.19382,2.19382,0,0,0,1.49118-.44444,1.10662,1.10662,0,0,0,.50407-1.02535q0-1.65921-1.93225-1.65921H5.96025Z" fill="#f9f7f7"/><rect x="0.00003" width="32" height="32" fill="none"/></g></svg>

<svg version="1" xmlns="http://www.w3.org/2000/svg" width="75" viewBox="-175 -166 594 580"><path fill="#F91D0A" d="M401.4 278.1h1.7c1.9 0 3.5-.5 3.5-2.2 0-1.3-.8-2.2-3.3-2.2a9 9 0 0 0-2 .2v4.3zm0 7.7h-2.6v-13.6a28 28 0 0 1 4.8-.4c2.3 0 3.4.4 4.3 1 .8.6 1.4 1.7 1.4 2.9 0 1.7-1.2 2.8-2.7 3.3v.1c1.2.5 1.9 1.6 2.3 3.3.4 2.1.6 3 1 3.4h-2.7c-.4-.5-.7-1.7-1-3.6-.3-1.5-1.2-2-3.2-2h-1.6v5.6zm2.6 6a13 13 0 1 1 0-26.2 13 13 0 0 1 0 26.2zm10.5-13a10.5 10.5 0 1 0-21 0 10.5 10.5 0 0 0 21 0z"/><path d="M-149.7 110.3l4.3-27.2c1.4-7.1 4.3-17.2 4.3-25.7h1.4c1.4 8.5 2.9 18.6 4.3 25.7l4.3 27.2h-18.6zm21.4 11.5l5.8 31.5h15.7L-131 41.6h-17.2l-25.8 111.7h15.8l5.7-31.5h24.3M-11.3 141.8c-10 0-12.9-15.7-12.9-28.6 0-12.9 2.9-30 13-30S.1 100.2.1 113.1c0 11.4-1.5 28.6-11.5 28.6zm0 13c11.5 0 27.2-10.1 27.2-41.6C16 86 4.5 71.7-11.3 71.7c-14.3 0-28.6 11.4-28.6 41.5 0 27.2 12.9 41.5 28.6 41.5"/><g fill="#F91D0A"><path d="M83.5 87.5A30.9 30.9 0 0 0 68.4 68v-.2l4.2-9.9L79 42.1C57.6-39.6 44.7-105.2 56.2-147.7c3.1-11 16-17.8 29.6-17.8l8.4.2h1.5c18.7-.3 27.6 23.5 28.6 32.8 1.6 15.5-5.5 41.6-5.5 41.6 0-10.6.4-27.6-6.3-42.3-7.7-17-15.1-27.2-21.8-28.9-3.3 2.3-6.6 7-7.7 15.9-2.3 12.5-3 28.3-3 36.4C80-81 85.7-43.1 96.8-4c2-6 4-11.8 5.4-17.3L119-86.9S115.3-11 110.2 12c-1 4.9-2.3 9.7-3.5 14.6a359 359 0 0 0 16.8 39.4l-.1.2c-2.6-.8-5.5-1.3-8.7-1.3-9.5 0-18.4 5-21.5 8a80.7 80.7 0 0 0-9.7 14.7zM121.8 121.3h21.5v-15l-.1-5.7v-.2a303.5 303.5 0 0 0 46.7 56 260 260 0 0 0 48 33.1c36.4-5.2 69.8-7.6 97.7-7.3 37 .5 64.1 6 75.1 16.8a28.6 28.6 0 0 1 8.3 18.7c.1 2.8-1.2 9.3-1.6 11 .4-2 .4-11.8-29.3-21.3-23.4-7.4-67.2-7.2-119.7-1.6 60.7 29.7 120 44.5 138.7 35.6 4.6-2.2 10.2-9.8 10.2-9.8s-3.4 15-5.7 18.8c-3 4-9 8.5-14.6 10-29.7 7.8-106.8-10.4-174-48.9C147.9 222.6 65.4 243-.7 264.7c-65 114-113.9 166.2-153.6 146.3l-14.6-7.3c-6-3.4-6.9-11.7-5.5-18.4 4.6-22.7 33-56.8 90.2-91 6.1-3.7 33.5-18.1 33.5-18.1s-20.3 19.6-25 23.4C-121.3 337-155 384-154.1 402.2l.2 1.6c38.7-5.6 96.8-84.3 171.4-230.4l5.9-11.5h29.9L41 185.5a2781 2781 0 0 1-35.9 65.3c62.3-26.1 129.2-42.8 193-54.7a310.5 310.5 0 0 1-76.3-75v.1z"/></g><path d="M203.9 54.5c1.4 0 4.3-1.4 7.2-1.4 12.8 0 17.1 10 17.1 21.4 0 13-7.1 21.5-18.6 21.5H204V54.5zm-15.7 98.8h15.7v-44.4h5.7c10 0 20-4.3 27.2-11.5 4.3-5.7 7.2-14.3 7.2-24.3s-2.9-18.6-8.6-24.3c-5.7-5.8-15.7-8.6-27.2-8.6-7.2 0-14.3 1.4-18.6 2.8l-1.4 110.3M266.9 54.5c1.4-1.4 4.3-1.4 5.7-1.4 15.8 0 24.4 15.7 24.4 41.5 0 35.8-13 45.8-25.8 45.8h-4.3v-86zm-15.7 98.8h15.7c14.3 0 24.3-2.9 31.5-11.5 8.6-7.1 14.3-22.9 14.3-47.2 0-23-5.7-37.2-14.3-44.4-7.2-7.2-15.8-10-28.6-10-7.2 0-13 1.4-18.6 2.8v110.3M321.3 41.6h44.4v12.9H337v35.8h27.2v14.3H337v48.7h-15.8V41.6"/><path d="M151.2 84h1.7c1.9 0 3.5-.6 3.5-2.2 0-1.3-.8-2.2-3.3-2.2a9 9 0 0 0-2 .1V84zm0 7.7h-2.6V78a28 28 0 0 1 4.8-.4c2.3 0 3.4.4 4.3 1 .8.6 1.4 1.7 1.4 3 0 1.7-1.2 2.7-2.7 3.2v.2c1.2.5 1.9 1.5 2.3 3.2.4 2.2.6 3 1 3.5H157c-.5-.5-.8-1.7-1.1-3.6-.3-1.5-1.2-2.1-3.2-2.1h-1.6v5.7zm2.6 6a13 13 0 1 1 0-26.2 13 13 0 0 1 0 26.1zm10.5-13.1a10.5 10.5 0 1 0-21 0 10.5 10.5 0 0 0 21 0z"/><path d="M100.8 104.6c0-10 4.3-21.5 11.5-21.5 7.1 0 11.4 7.2 11.4 21.5h-22.9zm37.2 11.5v-8.6c0-20-7.1-35.8-24.3-35.8-17.2 0-28.6 15.7-28.6 41.5s10 41.5 30 41.5c7.8 0 15.8-1.4 20-4.3l-2.8-11.4a34.2 34.2 0 0 1-12.9 2.8c-10 0-18.6-5.7-18.6-25.7H138"/><path fill="#1A171B" d="M-62.4 100.2c0-1.7-.4-4.2-1-5.8-1.3-5.1-5.2-9.9-9.9-9.9-9.4 0-13.4 11.4-13.4 27.9 0 18.1 3.8 29.5 13.3 29.5 3.4 0 7.6-2 10-9.7a18 18 0 0 0 1-6v-26zm15.7 30c0 7.2.4 16.4.6 23h-13.1l-1-9.6h-.5c-3.9 7.9-11 11-17.6 11-13.6 0-24.2-15.2-24.2-43.7 0-22.5 10.3-39.5 24.4-39.5 7 0 11.6 3.3 15.3 9.6h.3V38.9h15.8v91.3zM39.8 126.2c0 2.3.5 4.5 1 6 2.5 7.8 6.7 9.7 10 9.7 9.5 0 13.4-11.4 13.4-29.5 0-16.5-4.1-27.9-13.5-27.9-4.7 0-8.6 4.8-10 9.9-.4 1.6-.9 4.1-.9 5.8v26zM24.1 39H40v42h.3c3.7-6.2 8.2-9.5 15.3-9.5 14.1 0 24.4 17 24.4 39.5 0 28.5-10.5 43.7-24.2 43.7-6.5 0-13.7-3.1-17.6-11h-.4l-1 9.7H23.4c.2-6.7.6-15.9.6-23.1V38.9z"/></svg>

`flextable` objects can be rendered in HTML format, Microsoft Word, Microsoft 
PowerPoint and PDF.

> The following table is made with function `flextable` and dataset data:

```{r}
data <- iris[c(1:3, 51:53, 101:104),]
```


```{r warning=FALSE, echo=FALSE}
library(flextable)
typology <- data.frame(
  col_keys = c( "Sepal.Length", "Sepal.Width", "Petal.Length",
                "Petal.Width", "Species" ),
  what = c("Sepal", "Sepal", "Petal", "Petal", "Species"),
  measure = c("Length", "Width", "Length", "Width", "Species"),
  stringsAsFactors = FALSE )

ft <- flextable(
  data, 
  col_keys = c("Species", "sep_1", "Sepal.Length", "Sepal.Width", 
               "sep_2",  "Petal.Length", "Petal.Width" ) )

ft <- set_header_df(ft, mapping = typology, key = "col_keys" )
ft <- merge_h(ft, part = "header")
ft <- merge_v(ft, j = "Species", part = "body")
ft <- merge_v(ft, j = "Species", part = "header")
ft <- theme_booktabs(ft)
ft <- empty_blanks(ft)
ft <- fix_border_issues(ft)
autofit(ft) 
```


## Flextable rendering

When working in RStudio, flextable will be printed in the rstudio viewer pane, the default format is HTML output. 

We will use the following example:

```{r}
ft <- flextable(head(mtcars))
ft <- autofit(ft)
ft
```

### R Markdown documents

One great feature of `flextables` is that it can be used in R Markdown 
documents; HTML, Word, PowerPoint and PDF outputs are managed with 
method `knitr::knit_print`. 

Print the `flextable` object in the rmarkdown's \code{render} chunk 
as demonstrated in this document (...generated from an R Markdown 
document).

````

> this is how to print a flextable in a R Markdown document

```{r eval=FALSE}
ft
```

````


#### pandoc versions

Supported formats require some minimum [pandoc](https://pandoc.org/installing.html) versions: 

|                    R Markdown output | pandoc version |                 comment                |
|-------------------------------------:|:--------------:|:--------------------------------------:|
|                  `rmarkdown::html_*` |     >= 1.12    |                                        |
|           `rmarkdown::word_document` |     >= 2.0     | require a recent RStudio (> june 2018) |
| `rmarkdown::powerpoint_presentation` |     >= 2.4     |       require pandoc installation      |
|            `rmarkdown::pdf_document` |     >= 1.12    |  produces an image - limited support   |

#### Notes

* HTML format is the default format. 
* The best option to produce PDF documents containing flextable objects is by using 
package `pagedown`. The only current known limitation is the inability to repeat header 
rows along pages when the table need more than a page. 
* Using flextable with template `pdf_document` is OK if the flextable fits on one single page. 
The PDF output is not a real latex output but a PNG image.
* The package is not to be used for producing table with thousand rows. The package is to be used 
when there is a need to produce nice tables in a document or in a publication.

### PowerPoint or Word documents 

#### In an interactive session

If you have a Word or PowerPoint client on your machine, you can use the `print` method 
with argument `preview` set to "pptx" or "docx". It will produce and open a 
document where the table will be printed and ready to go to your clipboard. 

```{r eval=FALSE}
print(ft, preview = "docx")
print(ft, preview = "pptx")
```

#### With package officer

To add these objects in PowerPoint or Word documents, use functions:

- `ph_with_flextable()` or `ph_with_flextable_at()` (PowerPoint)
- `body_add_flextable()` (Word)

```{r}
library(officer)
```

The following is producing a PowerPoint document:

```{r eval=FALSE}
ppt <- read_pptx()
ppt <- add_slide(ppt, layout = "Title and Content", master = "Office Theme")
ppt <- ph_with_flextable(ppt, value = ft, type = "body") 

print(ppt, target = "assets/pptx/example.pptx")
```

The following is producing a Word document:

```{r eval=FALSE}
doc <- read_docx()
doc <- body_add_flextable(doc, value = ft)
print(doc, target = "assets/docx/example.docx")
```

### Images

To get an image file from a `flextable` object, use function `save_as_image`.

```{r}
img_file <- tempfile(fileext = ".png")
save_as_image(ft, path = img_file)
```


### As an R graphic

To get a plot from a `flextable` object, use function `plot`.

```{r fig.asp=flextable_dim(ft)$aspect_ratio, fig.width=flextable_dim(ft)$width*3,out.width=flextable_dim(ft)$width*72}
plot(ft)
```

> To add a flextable on a ggplot2 object, one can use `flextable::as_raster` 
and `grid.raster` or `rasterGrob`. See [Examples](./offcran/examples.html#send-your-flextable-to-ggplot) for an example.

---


## Getting started

The main function is `flextable`.

`flextable` function is producing flexible tables where each cell can contain 
several chunks of text with their own set of formatting properties 
(bold, font color, etc.). 

The function is using default values to format the table. It is also using 
a simple formatting function to create the paragraphs of text that will 
be rendered in each cell. All these default values can be modified after 
the flextable creation. 

The following illustration is presenting most of the functions 
available to format a flextable:

![](https://www.ardata.fr/img/illustrations/flextable_functions.svg)

### flextable keypoints

* A flextable is an object that will produce a reporting table from a 
`data.frame` object. 

* A flextable is containing three parts, header, body and footer. 
By default, there is only one header row containing the names of the data.frame. 
The body part is containing data from the data.frame. The footer 
part is not implemented by default.

```{r echo=FALSE}
dmodel <- data.frame( 
  header = rep("body", 4 ),
  header_1 = c("data[1,1]", "data[2,1]", "...", "data[n,1]" ),
  header_2 = c("data[1,2]", "data[2,2]", "...", "data[n,2]" ),
  header_3 = c("data[1,3]", "data[2,3]", "...", "data[n,3]" ),
  header_4 = c("data[1,4]", "data[2,4]", "...", "data[n,4]" ),
  header_5 = c("data[1,5]", "data[2,5]", "...", "data[n,5]" ), 
  stringsAsFactors = FALSE
)
header_model <- data.frame(
  title1 = c( "header", rep("row 1 - cell from 1 to 5", 5) ),
  title2 = c( "header", rep("row 2 - cell from 1 to 2", 2), rep("row 2 cell from 3 to 5", 3) ),
  title3 = c( "header", sprintf("row 3 cell %.0f", 1:5) ), 
  key = c( names(dmodel)), 
  stringsAsFactors = FALSE )

data_model <- flextable( data = dmodel, 
                            col_keys = c("header", "blank", "header_1", "header_2", "header_3", "header_4", "header_5" ) )
data_model <- set_header_df(data_model, mapping = header_model, key = "key")
data_model <- merge_h(data_model, part = "header")

data_model <- add_footer(data_model, 
                         header = "footer",
                         header_1 = "Grouped footer 1.1", 
                         header_2 = "Grouped footer 1.1", 
                         header_3 = "Grouped footer 1.2", 
                         header_4 = "Grouped footer 1.2", 
                         header_5 = "Grouped footer 1.2" )
data_model <- add_footer(data_model, top = FALSE,
                         header = "footer",
                         header_1 = "Grouped footer 2.1", 
                         header_2 = "Grouped footer 2.1", 
                         header_3 = "Grouped footer 2.1", 
                         header_4 = "Grouped footer 2.1", 
                         header_5 = "Grouped footer 2.1" )
data_model <- merge_h(data_model, part = "footer")
data_model <- merge_v(data_model, part = "footer", j = 1)
data_model <- merge_v(data_model, part = "body", j = 1)
data_model <- merge_v(data_model, part = "header", j = 1)
data_model <- theme_box(data_model)
data_model <- flextable::align(data_model, align = "center", part = "all")
data_model <- bg(data_model, bg = "#eb5555", part = "header")
data_model <- bg(data_model, bg = "#475F77", part = "body")
data_model <- bg(data_model, bg = "#2BBBD8", part = "footer")
data_model <- color(data_model, color = "white", part = "footer")
# data_model <- bg(data_model, j = 1, bg = "#475F77", part = "all")
data_model <- width(data_model, j = 1, width = 1.2)
data_model <- width(data_model, j = 2, width = .2)
data_model <- width(data_model, j = 3:7, width = 1.2)

std_border <- fp_border(width = 1.5, color = "white")

data_model <- border_outer(data_model, part="all", border = std_border )
data_model <- border_inner_h(data_model, border = std_border, part="all")
data_model <- border_inner_v(data_model, border = std_border, part="all")

data_model <- empty_blanks(data_model)
data_model <- padding(data_model, padding = 4, part = "all")
data_model <- fontsize(data_model, size = 12, part = "all")
data_model <- italic(data_model, italic = FALSE, part = "footer")
data_model <- bold(data_model, bold = TRUE, part = "all")
data_model <- color(data_model, color = "white", part = "all")
data_model
```


* Any formatting property related to text, paragraphs, 
cells in the table can be modified. 


* A cell is made of one single paragraph of text. Paragraphs 
can contain several chunks of text with different formatting 
but also images. 

* The dimensions of the flextable elements, widths of columns and 
heights of rows, are always defined. Beeing able to define the exact 
size necessary to **display data on a single line** is a choice made 
to make sure HTML, pptx, docx, images have all the same rendering, for 
that exact widths and heights were needed. In most of cases, you should 
not worry about that by only using `autofit()` as last operation. 
See functions `autofit()` and `dim_pretty()`. 

* Columns to display (`col_keys`) are by default all columns 
of the data.frame but can be choosen from a subset of existing 
columns and also unexisting columns. Unexisting columns are 
containing blanks by default but this content can be customized.


Let's have a step by step demo. First create a flextable and change header font in bold. 

```{r warning=FALSE}
library(flextable)
library(officer)

myft <- flextable(
  head(mtcars), 
  col_keys = c("am", "carb", "gear", "mpg", "drat" ))
myft
```

**flextable**: it is creating a flextable object based on input data. 
Optional argument `col_keys` is used to only display a subset of columns. 

Functions `theme_` are sugar functions whose role is to apply a set 
of formatting instructions to a flextable. For example, `theme_vanilla` 
set specific borders, right align paragraphs and make headers bold. 

```{r warning=FALSE}
myft <- theme_vanilla(myft)
myft
```

### Layout

Table layout can be modified. One can add or change header/footer rows, change cells height and width and merge cells. 

Also, there is an important function named `autofit` (it adjusts widths and heights regarding to text widths and heights).


```{r warning=FALSE}
myft <- merge_v(myft, j = c("am", "carb") )
myft <- set_header_labels( myft, carb = "# carb." )
myft <- autofit(myft)
myft
```

To learn more, see article about [layouts](./layout.html).


### Formatting

> To learn more, see article about [format](./format.html).

Many sugar functions can be used to format flextables: `bg()`, `fontsize()`, `italic()`, `bold()`, `color()`, `padding()`... 

Conditional formatting can be made by using the selector arguments. All formatting functions are accepting selector arguments. 

```{r}
myft <- italic(myft, j = 1)
myft <- bg(myft, bg = "#C90000", part = "header")
myft <- color(myft, color = "white", part = "header")
myft <- color(myft, ~ drat > 3.5, ~ drat, color = "red")
myft <- bold(myft, ~ drat > 3.5, ~ drat, bold = TRUE)
myft <- autofit(myft)
myft
```

