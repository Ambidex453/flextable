---
title: "flextable R package"
output:
  github_document:
    toc: true 
    toc_depth: 2
---


<!-- README.md is generated from README.Rmd. Please edit that file -->

[![Build Status](https://travis-ci.org/davidgohel/flextable.svg?branch=master)](https://travis-ci.org/davidgohel/flextable)
[![Coverage Status](https://img.shields.io/codecov/c/github/davidgohel/flextable/master.svg)](https://codecov.io/github/davidgohel/flextable?branch=master)
[![CRAN version](http://www.r-pkg.org/badges/version/flextable)](https://cran.r-project.org/package=flextable) ![](http://cranlogs.r-pkg.org/badges/grand-total/flextable)
[![Project Status: WIP - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](http://www.repostatus.org/badges/latest/wip.svg)](http://www.repostatus.org/#wip)

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```


## API


A tabular reporting tool that let R users create tables for reporting and control their formatting properties and their layout. 

- Manage headers
- Format text, paragraphs, cells and border of any element
- Separate data from displayed values
- Outut availables are Microsoft Word, PowerPoint and HTML (as an `htmlwidgets` object).

## Installation

You can get the development version from GitHub:

```{r eval = FALSE}
devtools::install_github("davidgohel/oxbase")
devtools::install_github("davidgohel/flextable")
```


## Quick demo

`flextable` is designed for use with the `%>%` pipe operator. You can make this `%>%` operator available in your R workspace by loading package [`magrittr`](https://cran.r-project.org/package=magrittr).

```{r load-package, message=FALSE}
library("magrittr")
library("flextable")
library("oxbase")
library("dplyr")
```

The following dataset will be used as input paramter of `flextable` call:

```{r}
mydata <- iris %>% 
  group_by(Species) %>% 
  do( head(., n = 3) )
mydata
```

The following styles are to be used later.

```{r}
def_txt <- fp_text(font.size = 9, font.family = "Arial", color = "gray40")
def_head <- update(def_txt, font.size = 11, color = "gray20")
def_cell <- fp_cell( border = fp_border(color = "gray") )
```

First, define the flextable.

```{r}
ft <- flextable(mydata, col_keys = c("Species", 
    "Sepal.Length", "Sepal.Width", "Petal.Length", 
    "Petal.Width") )
```

Add titles to header part.

```{r}
ft <- flextable(mydata, col_keys = c("Species", 
    "Sepal.Length", "Sepal.Width", "Petal.Length", 
    "Petal.Width") ) %>%
  set_header_labels(Sepal.Length = "Length", 
             Sepal.Width = "Width",
             Petal.Length = "Length",
             Petal.Width = "Width", 
             Species = "Species" ) %>%
  add_header(Sepal.Length = "Sepal", 
             Sepal.Width = "Sepal",
             Petal.Length = "Petal",
             Petal.Width = "Petal", 
             Species = "Species") 
```

Merge some cells.

```{r}
ft <- ft %>% 
  merge_h(part = "header") %>% 
  merge_v(part = "header") %>% 
  merge_v(j = "Species" ) 
```

Then apply some formatting properties :

```{r 'tabwid_example'}
ft <- ft %>% 
  theme_tron() %>% 
  autofit() 
```

```{r echo=FALSE, results='asis'}
codes <- flextable:::html_flextable(ft)
cat(codes)
cat("<style>", attr(codes, "css"), "</style>")
```


