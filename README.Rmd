---
title: "flextable R package"
output:
  github_document:
    toc: true 
    toc_depth: 2
---


<!-- README.md is generated from README.Rmd. Please edit that file -->

[![Build Status](https://travis-ci.org/davidgohel/flextable.svg?branch=master)](https://travis-ci.org/davidgohel/flextable)
[![Coverage Status](https://img.shields.io/codecov/c/github/davidgohel/flextable/master.svg)](https://codecov.io/github/davidgohel/flextable?branch=master)
[![CRAN version](http://www.r-pkg.org/badges/version/flextable)](https://cran.r-project.org/package=flextable) ![](http://cranlogs.r-pkg.org/badges/grand-total/flextable)
[![Project Status: WIP - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](http://www.repostatus.org/badges/latest/wip.svg)](http://www.repostatus.org/#wip)

```{r, echo = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```


## API


An API is available to let R users create tables for reporting and control their formatting properties and their layout. A `flextable` object is a data.frame representation, it can be manipulated with functions that give control over:

- headers managment 
- text, paragraphs, cells and border formatting of any element
- displayed values

`flextable` objects can be rendered in Microsoft Word, PowerPoint and HTML documents.

## Installation

You can get the development version from GitHub:

```{r eval = FALSE}
devtools::install_github("davidgohel/flextable")
```


## Example

`flextable` is designed for use with the `%>%` pipe operator. You can make this `%>%` operator available in your R workspace by loading package [`magrittr`](https://cran.r-project.org/package=magrittr).

```{r load-package}
library("magrittr")
library("flextable")
```

The following dataset will be used as input parameter of `flextable` call.

```{r}
library("dplyr")
mydata <- iris %>% 
  group_by(Species) %>% 
  do( head(., n = 3) )
mydata
```

The following *styles* objects are to be used later, they will used to change formatting properties of the `flextable` object.

```{r}
def_txt <- fp_text(font.size = 9, font.family = "Arial", color = "gray40")
def_spe <- update(def_txt, font.size = 11, color = "#995555B3", bold = TRUE, italic = TRUE)
def_cell <- fp_cell( border = fp_border(color = "gray") )
```

First step is to create a flextable. Dataset `mydata` is used as input table.

```{r}
ft <- flextable(mydata, col_keys = c("Species", 
    "Sepal.Length", "Sepal.Width", "Petal.Length", 
    "Petal.Width") )
```

Then, functions `set_header_labels` and  `add_header` will replace 
default table column names and add a new row.

```{r}
ft <- flextable(mydata, col_keys = c("Species", 
    "Sepal.Length", "Sepal.Width", "Petal.Length", 
    "Petal.Width") ) %>%
  set_header_labels(Sepal.Length = "Length", Sepal.Width = "Width",
             Petal.Length = "Length",Petal.Width = "Width", 
             Species = "Species" ) %>%
  add_header(Sepal.Length = "Sepal", Sepal.Width = "Sepal",
             Petal.Length = "Petal", Petal.Width = "Petal", 
             Species = "Species") 
```

Cells can be merged when consecutive cells have identical values, `merge_h` and `merge_v` will merge horizontally and vertically cells. Argument `part` specify the part of the flextable (header or body or all) where the function should be applied. Here we will only merge identical cells in the header part of the table.

```{r}
ft <- ft %>% 
  merge_h(part = "header") %>% 
  merge_v(part = "header")
```

Then apply some formatting properties :

```{r}
ft <- ft %>% theme_vanilla() %>% 
  style(j = ~ Species, part = "all", pr_t = def_spe ) %>% 
  bg(i = ~ Sepal.Length > 6.8, bg = "wheat") %>% 
  color(i = ~ Sepal.Width > 3.25, j = 2:4, color = "orange" )
```

The flextable is displayed as an `htmlwidget` when calling function `tabwid`.


```{r 'tabwid_example'}
ft %>% autofit() %>% tabwid()
```




